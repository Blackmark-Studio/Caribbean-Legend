// Арчибальд Колхаун
void ProcessDialogEvent()
{
	ref NPChar, sld;
	aref Link, NextDiag;
	int i;

	DeleteAttribute(&Dialog,"Links");

	makeref(NPChar,CharacterRef);
	makearef(Link, Dialog.Links);
	makearef(NextDiag, NPChar.Dialog);
	
	switch(Dialog.CurrentNode)
	{
		case "First time":
			dialog.text = "何かご用ですか？";
			link.l1 = "いいえ、何もない。";
			link.l1.go = "exit";			
			NextDiag.TempNode = "First time";
		break;
		
		case "portroyal":
			dialog.text = "はは、ド・モール旦那！ポートロイヤルへようこそ！まだ俺のことを覚えてるか？";
			link.l1 = "ふむ……お前はカルフーンだろう？ヘンリー・カルフーンか？";
			link.l1.go = "portroyal_1";
		break;
		
		case "portroyal_1":
			dialog.text = "もう少しで……アーチボルド・カルフーン。";
			link.l1 = "ああ、失礼しました、旦那。はい、あなたのことを覚えています。カポ・カトーチェの湾でお会いしましたね。 あなたの船長、ウィリアム・パターソンも一緒でした。彼の艦隊も見覚えがあります。";
			link.l1.go = "portroyal_2";
		break;
		
		case "portroyal_2":
			dialog.text = "まったくその通りだ！どうかうちの船長を許してやってくれ。知らない相手にはいつも無礼なんだ。 君は本当に見事だったよ、ディエゴ・デ・モントーヤの砦を電撃的に攻略してくれてな。 俺たちもちょうどあそこで腕を磨いていたところさ…";
			link.l1 = "正義のためだと言っておこう。だが、君の船長が事前に準備してくれなければ、 スペインの大砲の砲火の中で賞品に駆け寄ることすらできなかっただろう。\n君の指揮官は探していたものを見つけたのか？";
			link.l1.go = "portroyal_3";
		break;
		
		case "portroyal_3":
			dialog.text = "はい。彼は砦の地下にあるカズマットにかなり深く潜り込み、何やら記録庫のようなものを見つけて、 とても満足そうでした。\nところで、差し支えなければお聞きしますが、あなたがあのジャングルの砦を攻撃したきっかけは何だったのですか？";
			link.l1 = "サン・ピエールで俺に敗れた後、ドン・ディエゴは陰謀を巡らせ、ついにはキューバへの公然たる攻撃を仕掛けてきた。 だが、戦闘を中断して本土方面の山へ逃げやがったんだ。まあ、 俺はあの腰抜け野郎を二度とフランスの恥さらしにさせないためにも、きっちりケリをつけてやると決めたのさ。";
			link.l1.go = "portroyal_4";
		break;
		
		case "portroyal_4":
			dialog.text = "ああ、シャルル・ド・モール船長の武勇伝はずいぶん耳にしてきたが……今、自分の目で確かめたぞ…";
			link.l1 = "ああ、ウィリアム・パターソンの勇敢さについても少し聞いたことがある。あんな船長がいて、お前は幸運だな。";
			link.l1.go = "portroyal_5";
		break;
		
		case "portroyal_5":
			dialog.text = "運がいいな、確かにそうだ。あいつも今じゃすっかり偉い人間になっちまって、上流社会の男だ、謁見や舞踏会、 パレードに私的なパーティー……俺たちがポートロイヤルに着くたびに、総督の宮殿から引っ張り出すことなんてできやしねえ。 実は今もまたそこにいるのさ。\nシャルル・ド・モール船長、スコットランドの酔っ払いに一つ頼みを聞いてくれねえか？俺の仲間になって、 ちょっと話でもしようぜ！いつも同じ面ばかり見てるのはうんざりだし、あんたは話し相手によさそうだ。 俺の家に来てくれ、ゆっくりして、極上のウイスキーを樽ごと飲もう。奢るぜ！";
			link.l1 = "ふむ……魅力的だが……";
			link.l1.go = "portroyal_6";
		break;
		
		case "portroyal_6":
			dialog.text = "おやめなさいよ、船長。たまにはあなたも休まなきゃ。\nところで、地元の商人の店から仕入れた上等なオードブルがあるの。\n私はその店の真上の部屋を借りてるから、\n何か食べたくなったり飲みたくなったら、階段を降りてくるだけで用意できてるわ、ははっ！便利でしょ？\nさあ、行きましょう！";
			link.l1 = "君の説得に乗ってしまったぜ！";
			link.l1.go = "portroyal_7";
		break;
		
		case "portroyal_7":
			dialog.text = "よし。ついて来い！";
			link.l1 = "...";
			link.l1.go = "portroyal_8";
		break;
		
		case "portroyal_8":
			DialogExit();
			NextDiag.CurrentNode = "portroyal_9";
			LAi_SetActorType(pchar);
			LAi_SetActorType(npchar);
			LAi_ActorGoToLocation(npchar, "reload", "reload6_back", "PortRoyal_store", "goto", "goto2", "GuardOT_ArchyIntoStore", -1);
			LAi_ActorFollow(pchar, npchar, "", -1);
		break;
		
		case "portroyal_9":
			LAi_SetSitType(Pchar);
			dialog.text = "ここは気持ちいいだろう？涼しくて最高だ…ほら、ウイスキーの樽があるぜ！さあ、飲もう、船長！";
			link.l1 = "さて、俺たちの幸運な出会いと楽しい知り合いになれたことに乾杯しようぜ！";
			link.l1.go = "portroyal_10";
		break;
		
		case "portroyal_10":
			dialog.text = "嬉しいですわ！…あら！あなたは最近カリブに到着されたのでしょう、ド・モール様？";
			link.l1 = "比較的最近……いや、そうでもないかもしれない。どう言えばいいのか、よく分からないんだ。ここで半生を過ごしたような気がするよ。 ";
			link.l1.go = "portroyal_11";
		break;
		
		case "portroyal_11":
			dialog.text = "ああ、その気持ちはよく分かるよ……俺もここには長くいるからな。ウィリアムに助けられたあの忌々しい島に上陸したときなんて……おお、あそこで人生の半分に別れを告げたような気分だったぜ。";
			link.l1 = "面白いな！それはどの島だったんだ？";
			link.l1.go = "portroyal_12";
		break;
		
		case "portroyal_12":
			dialog.text = "ウィリーは俺の古い友人だ。まだスコットランドの澄んだ空気を吸っていた頃からの付き合いさ。あの頃は良かったな。 俺は愚かにもあの忌々しいカトリック野郎どもと異端審問官本人と揉め事を起こしてしまってな、 そいつが俺の暗殺を仕組んだんだ。当時は商人で、自分のフリュート船も持ってた。あの日、 スペイン人どもが海賊の格好で俺の船を襲ってきやがった。俺たちは勇敢に戦ったが、 結局ネズミのように追い詰められちまった！それでも、コルホーンのじいさんは冷静さを失わず、 水の入った樽と数枚の板を抱えて海に飛び込んだんだ。俺は闇に紛れて兵士たちに見つからずに船から泳いで逃げた。 生き延びる可能性はほとんどなかったが、船に残っていれば望みはゼロだった。二日後、 俺はどこかの無人島の浜辺に打ち上げられていた。その頃にはカリブでしばらく暮らしていたが、 そんな島のことはそれまで聞いたこともなかった！小さくて、完全に無人の島だ……そこで二年も過ごしたよ、まるで永遠のように感じた。どうやって正気を保てたのか、今でも自分でも分からねえ。";
			link.l1 = "無人島で二年間も暮らしていたのか？";
			link.l1.go = "portroyal_13";
		break;
		
		case "portroyal_13":
			dialog.text = "ああ、まったくだ、この呪われた島め！だが幸いにも真水があったんだ。カニやフジツボ、魚や鳥を食って生き延びたぜ。 だからこそ、俺はここをカニ島と名付けたんだ。武器なんて何もなかったからな、野蛮人みたいに銛や槍、 矢を使いこなせるようになったんだよ！おおっ！飲め飲め、船長！俺も一杯やらせてもらうぜ…";
			link.l1 = "ああ……お前のことは羨ましくねえよ。";
			link.l1.go = "portroyal_14";
		break;
		
		case "portroyal_14":
			dialog.text = "ほらな！俺があの広い砂浜に初めて足を踏み入れたとき、まさに同じことを言ったんだ――「アーチーじいさん、お前の状況は羨ましいもんじゃねえが、絶望的ってわけでもねえ！」ってな！\nそれでな、船長、俺を生き延びさせたものが何かわかるか？";
			link.l1 = "島のそばを通る船か？";
			link.l1.go = "portroyal_15";
		break;
		
		case "portroyal_15":
			dialog.text = "いや！俺を救ったのは努力だ！労働と信仰、そして生きたいという意志だ！島の隅々まで探検して回ったら、 大工道具や筆記用具、それに他の小物が詰まった箱を見つけたんだ。その瞬間、自分にこう言ったのさ――もっと注げ、船長、どんどん注げってな！\nこうも言った。アーチー、お前は心を保つために働かなきゃならない、神様は始めるためのすべてを与えてくれたぞ、と。 わかったか？俺は湾の近くに家を建て始めたんだ。そしたらどうなったと思う？それが俺を暗い考えから救い、 生きる理由を与えてくれたんだ！";
			link.l1 = "カルフーンさん、あなたは生きる手本です。あんな状況で何かできる男なんて、そうはいませんよ……";
			link.l1.go = "portroyal_16";
		break;
		
		case "portroyal_16":
			dialog.text = "そうさ、カールハウン爺さんがスコットランド生まれなのには理由があるんだ！そうだろ！俺たちは山の息子――強くて、勇敢で、タフだ。あの湿地のひ弱どもなんかよりずっとな。もっと注いでくれ……あれ、何の話だったっけ？ああ、そうだ！俺は一生懸命働いて、自分のために立派な家を建てたんだ。それに、 毎日の不運を書き留めるための日記も始めた。その日記はウィリーに助けられた時も持ってきた。 今はこの机にしまってあって、ポートロイヤルに泊まるたびに、暖かくて柔らかいベッドで読み返してるんだ。そこには、 あそこに行く前も後も、俺に起きたことを全部書き記してある。それが、今でも俺が正気でいられる理由の一つなんだよ。 ";
			link.l1 = "つまり、パターソン旦那が君を島から拾い上げたってことか？だが、どうやってあの島を見つけたんだ？ 君はこう言ってたが…";
			link.l1.go = "portroyal_17";
		break;
		
		case "portroyal_17":
			dialog.text = "ああ、そうさ、その島はどの地図にも載ってねえんだ。でもウィリー、あいつは老いぼれウィリーだぜ！ 何だってできる男さ！あの忌々しい島を見つけて、俺を助けてくれたんだ。その恩は一生忘れねえよ。ああ……";
			link.l1 = "パターソン旦那に仕えるのは楽しいかい？また自分の力で旅に出てみたくはないか？";
			link.l1.go = "portroyal_18";
		break;
		
		case "portroyal_18":
			dialog.text = "もう独立なんてこりごりだ。ウィリーは若くて成功してるし、俺もあいつの長年の友人だ。他に何が必要だ？いや、 俺はウィリーと最期まで一緒にいるさ――少なくとも、次に俺が酔いつぶれて追い出されるまではな、はは！酔いつぶれると言えば、さあ、酒を注いでくれ！";
			link.l1 = "ああ…（飲みながら）カリューン旦那、ちょっと聞きたいんだが。あんた、昔は宝探しをやってたって噂を聞いたぜ。本当か？ それともデタラメか？";
			link.l1.go = "portroyal_19";
		break;
		
		case "portroyal_19":
			dialog.text = "誰に聞いたんだ？まあ、隠しても仕方ねえな。俺もかつてはそうだったんだよ。だが、うまくはいかなかった。 宝探しがきっかけで、あの忌々しいイエズス会と島に関わる羽目になった。 聖職者どもは俺のせいで一人の男を拷問して殺しちまったし、俺自身も……いや、過去のことはもういいだろう。\n俺は自分の罪には十分に報いを受けたし、二度と繰り返すつもりはねえ。いや、 ウィリーがそんなことは絶対にさせねえさ、間違いねえ！";
			link.l1 = "聞けよ、アーチボルド。ミゲル・ディチョーソって男の名を聞いたことがあるか？";
			link.l1.go = "portroyal_20";
		break;
		
		case "portroyal_20":
			dialog.text = "その名前は初めて聞くな。誰なんだ？";
			link.l1 = "ああ、別に面白い奴じゃないさ……ただ冒険と財宝探しが好きな男だよ。\nだが、あんたが知らねえなら、その話はここまでだな。";
			link.l1.go = "portroyal_21";
		break;
		
		case "portroyal_21":
			dialog.text = "ああ、それはやめておこう！代わりに古きヨーロッパの話をしようじゃないか！二十年前のスコットランドを思い出すな……\n";
			link.l1 = "...";
			link.l1.go = "portroyal_22";
		break;
		
		case "portroyal_22":
			DialogExit();
			AddDialogExitQuest("GuardOT_MCOutFromArchyRoom");
		break;
		
		case "Exit":
			NextDiag.CurrentNode = NextDiag.TempNode;
			DialogExit();
		break;
	}
}
